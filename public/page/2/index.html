<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>虫子樱桃</title>

<meta name="description" content="我来问道无馀说，云在青天水在瓶。">
<meta name="author" content="czyt">
<link rel="canonical" href="https://czyt.tech/" />
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.2300a0eceb56958fe6e1d606ffa0a755d9ef95657cbf4b79a3fa1d3b9dc8b654.css" integrity="sha256-IwCg7OtWlY/m4dYG/6CnVdnvlWV8v0t5o/odO53ItlQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://czyt.tech/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://czyt.tech/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://czyt.tech/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://czyt.tech/apple-touch-icon.png">
<link rel="mask-icon" href="https://czyt.tech/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.105.0">
<link rel="alternate" type="application/rss+xml" href="https://czyt.tech/index.xml">
<link rel="alternate" type="application/json" href="https://czyt.tech/index.json">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="虫子樱桃" />
<meta property="og:description" content="我来问道无馀说，云在青天水在瓶。" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://czyt.tech/" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="虫子樱桃"/>
<meta name="twitter:description" content="我来问道无馀说，云在青天水在瓶。"/>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "虫子樱桃",
  "url": "https://czyt.tech/",
  "description": "我来问道无馀说，云在青天水在瓶。",
  "thumbnailUrl": "https://czyt.tech/favicon.ico",
  "sameAs": [
      
  ]
}
</script>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://czyt.tech/" accesskey="h" title="虫子樱桃 (Alt + H)">虫子樱桃</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://czyt.tech/" title="🏠Home">
                    <span class="active">🏠Home</span>
                </a>
            </li>
            <li>
                <a href="https://czyt.tech/about/" title="🙋About">
                    <span>🙋About</span>
                </a>
            </li>
            <li>
                <a href="https://czyt.tech/post/" title="📚Posts">
                    <span>📚Posts</span>
                </a>
            </li>
            <li>
                <a href="https://czyt.tech/search/" title="🔍Search">
                    <span>🔍Search</span>
                </a>
            </li>
            <li>
                <a href="https://czyt.tech/tags/" title="🔖Tags">
                    <span>🔖Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 

<article class="post-entry"> 
  <header class="entry-header">
    <h2>go-kratos使用备忘
    </h2>
  </header>
  <section class="entry-content">
    <p>自定义接口返回内容 正常的响应序列化逻辑通过Response Encoder实现。
错误的序列化逻辑通过ErrorEncoder实现。
注意：自定义Encoder后，可能会遇到零值字段被忽略的情况，可以参考这个issue。具体的解决办法是
proto定义返回内容，然后将生成的类型在encoder中使用。
简单代码大致如下：
proto定义
import &#34;google/protobuf/any.proto&#34;; // BaseResponse is the base response message BaseResponse{ int32 code = 1 [json_name = &#34;code&#34;]; google.protobuf.Any data = 2 [json_name = &#34;data&#34;]; } go代码
func CustomResponseEncoder() http.ServerOption { return http.ResponseEncoder(func(w http.ResponseWriter, r *http.Request, i interface{}) error { reply := &amp;v1.BaseResponse{ Code: 0, } if m, ok := i.(proto.Message); ok { payload, err := anypb.New(m) if err != nil { return err } reply....</p>
  </section>
  <footer class="entry-footer"><span title='2022-08-12 00:00:00 +0000 UTC'>August 12, 2022</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;czyt</footer>
  <a class="entry-link" aria-label="post link to go-kratos使用备忘" href="https://czyt.tech/post/go-kratos-usage-memo/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Protobuf golang小札
    </h2>
  </header>
  <section class="entry-content">
    <p>Oneof 如果您有许多字段的消息，并且最多可以同时设置一个字段，则可以使用Oneof功能来执行此行为并保存内存。一个字段就像常规字段一样，除了单一共享内存中的所有字段，最多可以同时设置一个字段。设置Oneof的任何成员都会自动清除所有其他成员。
​	Google protobuf 文档#Oneof
示例proto 创建protoOneof.proto 的proto文件
syntax = &#34;proto3&#34;; package oneof_test; option go_package =&#39;.;oneof&#39;; message WeiboUser{ string user_id = 1; string user_nick = 2; } message DouyinUser{ string auth_token = 1; string nick_name = 2; } message User{ oneof user_source{ string weibo_url = 1; string douyin_url = 2; } oneof user_info{ WeiboUser weibo_user_info = 3; DouyinUser douyin_user_info = 4; } } 使用命令生成go代码
protoc --proto_path=. --go_out=paths=source_relative:./oneof ./protoOneof.proto 生成的protoOneof.pb.go代码如下：...</p>
  </section>
  <footer class="entry-footer"><span title='2022-07-25 00:00:00 +0000 UTC'>July 25, 2022</span>&nbsp;·&nbsp;12 min&nbsp;·&nbsp;czyt</footer>
  <a class="entry-link" aria-label="post link to Protobuf golang小札" href="https://czyt.tech/post/protobuf-golang-litle-notes/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>使用gotests生成表驱动测试
    </h2>
  </header>
  <section class="entry-content">
    <p>使用gotests可以很方便的生成表驱动测试代码，表驱动测试的具体内容，请参考go官方的wiki。下面是具体的使用方法。
安装 使用下面命令进行安装
go install github.com/cweill/gotests/gotests@latest 如果是go1.16之前的版本，可以使用命令 go get -u github.com/cweill/gotests/...来进行安装。
使用 gotests支持的参数如下：
Usage of C:\Users\czyt\go\bin\gotests.exe:-allgenerate tests for all functions and methods-excl stringregexp. generate tests for functions and methods that don&#39;t match. Takes precedence over -only, -exported, and -all-exportedgenerate tests for exported functions and methods. Takes precedence over -only and -all-i print test inputs in error messages-nosubtestsdisable generating tests using the Go 1....</p>
  </section>
  <footer class="entry-footer"><span title='2022-07-22 00:00:00 +0000 UTC'>July 22, 2022</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;czyt</footer>
  <a class="entry-link" aria-label="post link to 使用gotests生成表驱动测试" href="https://czyt.tech/post/use-gotests-to-generate-table-driven-tests/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>ETCD一键安装脚本
    </h2>
  </header>
  <section class="entry-content">
    <p>最近要使用ETCD，脚本根据官方GitHub脚本修改而来
#!/usr/bin/bash ETCD_VER=v3.5.4 # choose either URL GOOGLE_URL=https://storage.googleapis.com/etcd GITHUB_URL=https://fastgit.czyt.tech/https://github.com/etcd-io/etcd/releases/download ARCH=linux-arm64 DOWNLOAD_URL=${GITHUB_URL} INSTALL_DIR=/opt/etcd rm -f /tmp/etcd-${ETCD_VER}-${ARCH}.tar.gz rm -rf ${INSTALL_DIR} &amp;&amp; mkdir -p ${INSTALL_DIR} curl -L ${DOWNLOAD_URL}/${ETCD_VER}/etcd-${ETCD_VER}-${ARCH}.tar.gz -o /tmp/etcd-${ETCD_VER}-${ARCH}.tar.gz tar xzvf /tmp/etcd-${ETCD_VER}-${ARCH}.tar.gz -C ${INSTALL_DIR} --strip-components=1 rm -f /tmp/etcd-${ETCD_VER}-${ARCH}.tar.gz ${INSTALL_DIR}/etcd --version ${INSTALL_DIR}/etcdctl version ${INSTALL_DIR}/etcdutl version 其中的ARCH请根据实际情况修改。
参考 https://etcd.io/docs/v3.5/demo/ </p>
  </section>
  <footer class="entry-footer"><span title='2022-07-21 00:00:00 +0000 UTC'>July 21, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;czyt</footer>
  <a class="entry-link" aria-label="post link to ETCD一键安装脚本" href="https://czyt.tech/post/etcd-install-script/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Golang Expr不完全指南
    </h2>
  </header>
  <section class="entry-content">
    <p>安装 库的说明
Expr package provides an engine that can compile and evaluate expressions. An expression is a one-liner that returns a value (mostly, but not limited to, booleans). It is designed for simplicity, speed and safety.
The purpose of the package is to allow users to use expressions inside configuration for more complex logic. It is a perfect candidate for the foundation of a business rule engine.
安装
go get -u /github....</p>
  </section>
  <footer class="entry-footer"><span title='2022-07-13 00:00:00 +0000 UTC'>July 13, 2022</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;czyt</footer>
  <a class="entry-link" aria-label="post link to Golang Expr不完全指南" href="https://czyt.tech/post/golang-expr-uncompleted-reference/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Golang DSL参考
    </h2>
  </header>
  <section class="entry-content">
    <p>ANTLR 4 图书 The definitive ANTLR 4 reference (2014) 英文版下载 中文版下载 文章 使用ANTLR和Go实现DSL入门 手把手教你使用ANTLR和Go实现一门DSL语言part1 part2part3part4part5 Parsing with ANTLR 4 and Go 实例代码 bilibili gengine link go-zero link grule-rule-engine Others 图书 Writing A Compiler In Go Writing an Interpreter in Go µGo语言实现——从头开发一个迷你Go语言编译器 文章 Build your own DSL with Go &amp; HCL
How to Write Syntax Tree-Based Domain-Specific Languages in Go
Handwritten Parsers &amp; Lexers in Go
goyacc实战
TiDB SQL Parser 的实现...</p>
  </section>
  <footer class="entry-footer"><span title='2022-07-11 00:00:00 +0000 UTC'>July 11, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;czyt</footer>
  <a class="entry-link" aria-label="post link to Golang DSL参考" href="https://czyt.tech/post/golang-dsl-reference/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Vue 相关资源
    </h2>
  </header>
  <section class="entry-content">
    <p> Vue - The Complete Guide (incl. Router &amp; Composition API) The Vue.js 3 Masterclass TypeScript Friendly Vue 3 Vue.js Fundamentals </p>
  </section>
  <footer class="entry-footer"><span title='2022-06-30 00:00:00 +0000 UTC'>June 30, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;czyt</footer>
  <a class="entry-link" aria-label="post link to Vue 相关资源" href="https://czyt.tech/post/vue-related-resource/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Golang io.Pipe 使用
    </h2>
  </header>
  <section class="entry-content">
    <p>介绍 // Pipe creates a synchronous in-memory pipe. // It can be used to connect code expecting an io.Reader // with code expecting an io.Writer. // // Reads and Writes on the pipe are matched one to one // except when multiple Reads are needed to consume a single Write. // That is, each Write to the PipeWriter blocks until it has satisfied // one or more Reads from the PipeReader that fully consume // the written data....</p>
  </section>
  <footer class="entry-footer"><span title='2022-06-24 00:00:00 +0000 UTC'>June 24, 2022</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;czyt</footer>
  <a class="entry-link" aria-label="post link to Golang io.Pipe 使用" href="https://czyt.tech/post/golang-io-pipe-usage/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>go embed 使用小记
    </h2>
  </header>
  <section class="entry-content">
    <p>​ go embed 是go 1.16 开始添加的特性，允许嵌入文件及文件夹，在Go程序中进行使用。官方还为此添加了embed.FS的对象。下面将常用的使用场景进行简单列举：
嵌入单个文件 官方的例子
嵌入文件并绑定到字符串变量 import _ &#34;embed&#34; //go:embed hello.txt var s string print(s) 嵌入文件并绑定到字节变量 import _ &#34;embed&#34; //go:embed hello.txt var b []byte print(string(b)) 嵌入文件并绑定到文件对象 import &#34;embed&#34; //go:embed hello.txt var f embed.FS data, _ := f.ReadFile(&#34;hello.txt&#34;) print(string(data)) 嵌入目录 嵌入时，可以在多行或者一行输入要嵌入的文件和文件夹。
package server import &#34;embed&#34; // content holds our static web server content. //go:embed image/* template/* //go:embed html/index.html var content embed.FS 在匹配文件夹时，embed会嵌入包括子目录下的所有除.和_开头的文件（递归），所以上面的代码大致等价于下面的代码：
// content is our static web server content....</p>
  </section>
  <footer class="entry-footer"><span title='2022-06-23 00:00:00 +0000 UTC'>June 23, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;czyt</footer>
  <a class="entry-link" aria-label="post link to go embed 使用小记" href="https://czyt.tech/post/go-embed-usage-note/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Git小技巧
    </h2>
  </header>
  <section class="entry-content">
    <p>Windows下GIT的几个小技巧 记住git密码 使用下面命令可以设置记住git密码，但推荐使用ssh进行操作。
git config credential.helper store 设置换行符转换 在windows下开发时，迁出的代码是CRLF会导致编译的sh脚本不能正确执行:
git config --global core.autocrlf false Git推送到多个服务器 要实现一次push到多个远程仓库 本机git仓库A https://aaaaa.git 要同步push的远程git仓库B https://bbbbb.git
通过git remote add添加 先使用git remote -v查看远程仓库的情况 ,然后添加一个git仓库
git remote add b https://bbbbb.git 再次查看远程仓库情况，如果需要push，则需要push两次
通过git remote set-url 添加 如果按上面添加过remote分支，需要先git remote rm b,使用下面命令添加即可。
git remote set-url --add a https://bbbbb.git 查看远程仓库情况，看看是否已经是两个push地址了 。这个只需push一次就行了
修改配置文件 打开 .git/config 找到 [remote “github”]，添加对应的 url 即可，效果如下。这种方法其实和方法二是一样的。
[remote &#34;a&#34;] url = https://aaaaa.git fetch = &#43;refs/heads/*:refs/remotes/a/* url = https://bbbbb.git 参考链接
● 一个项目push到多个远程Git仓库 https://segmentfault....</p>
  </section>
  <footer class="entry-footer"><span title='2022-06-17 00:00:00 +0000 UTC'>June 17, 2022</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;czyt</footer>
  <a class="entry-link" aria-label="post link to Git小技巧" href="https://czyt.tech/post/git-tricks/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="prev" href="https://czyt.tech/">« Prev Page</a>
    <a class="next" href="https://czyt.tech/page/3/">Next Page »</a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://czyt.tech/">虫子樱桃</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
        <span id="busuanzi_container_site_pv">Total visited<span id="busuanzi_value_site_pv"></span>times</span>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }
const loadScript = (url, onloadFunction) => {
    var newScript = document.createElement("script");
    newScript.onerror =  (oError) => {
      throw new URIError("The script " + oError.target.src + " didn't load correctly.");
    };
    if (onloadFunction) { newScript.onload = onloadFunction; }
    document.head.insertAdjacentElement('beforeend', newScript);
    newScript.src = url;
  }
  
if (document.querySelectorAll('.mermaid').length > 0) {
      loadScript('https://cdnjs.cloudflare.com/ajax/libs/mermaid/9.1.1/mermaid.min.js', () => {
        document.head.insertAdjacentHTML("beforeend", `<style>.mermaid svg { background-color: #dadcd8 !important; }</style>`);
        // default, dark, neutral, forest
        mermaid.initialize({ startOnLoad: false, securityLevel: "strict", logLevel: 1, theme: "neutral" });
        
        
        mermaid.init();
        console.log("mermaid init done");
      })
    }
    
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
