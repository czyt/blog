<!DOCTYPE html>
<html>
<head>
	<title>AI Bot Code</title>
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<style>
		.code-avatar {
			background-size: cover;
			border-radius: 50%;
			height: 50px;
			width: 50px;
			display: inline-block;
			margin-right: 10px;
			background-color: #ccc;
		}
		.sender-avatar {
			background-size: cover;
			border-radius: 50%;
			height: 50px;
			width: 50px;
			display: inline-block;
			margin-right: 10px;
			background-color: #ccc;
		}
		.sender {
			color: #4CAF50;
			font-weight: bold;
		}
		.code {
			background-color: #f4f4f4;
			padding: 5px;
			margin: 0;
			font-size: 1.1em;
			line-height: 1.5em;
			border-left: 3px solid #4CAF50;
			font-family: monospace;
			overflow-x: auto;
			color: #333;
			background-color: #f8f8f8;
			border: 1px solid #ccc;
			border-radius: 4px;
		}
		.sender-avatar + .sender {
			margin-left: 10px;
		}
		.sender-avatar + .content {
			margin-left: 60px;
		}
		.message {
			display: flex;
			align-items: center;
			margin-bottom: 10px;
		}
		.message .sender-avatar {
			margin-right: 10px;
		}
		.message .sender {
			font-weight: bold;
			margin-right: 10px;
		}
		.message .time {
			margin-left: auto;
			color: #999;
			font-size: 0.8em;
		}
		.message .content {
			background-color: #f8f8f8;
			padding: 10px;
			border-radius: 10px;
			margin-right: 10px;
			flex: 1;
			border: 1px solid #ccc;
		}
		.message .code {
			background-color: #f4f4f4;
			padding: 10px;
			border-radius: 10px;
			margin-right: 10px;
			flex: 1;
			font-family: monospace;
			overflow-x: auto;
			color: #333;
			border: 1px solid #ccc;
		}
		.message .content:before {
			content: "";
			position: absolute;
			top: 0;
			left: -20px;
			border-top: 20px solid transparent;
			border-right: 20px solid #f8f8f8;
			border-bottom: 20px solid transparent;
			border-left: none;
		}
		.message .content:after {
			content: "";
			position: absolute;
			top: 0;
			left: -18px;
			border-top: 20px solid transparent;
			border-right: 20px solid #ccc;
			border-bottom: 20px solid transparent;
			border-left: none;
			margin-left: -1px;
		}
		.message .code:before {
			content: "";
			position: absolute;
			top: 0;
			left: -20px;
			border-top: 20px solid transparent;
			border-right: 20px solid #f4f4f4;
			border-bottom: 20px solid transparent;
			border-left: none;
		}
		.message .code:after {
			content: "";
			position: absolute;
			top: 0;
			left: -18px;
			border-top: 20px solid transparent;
			border-right: 20px solid #ccc;
			border-bottom: 20px solid transparent;
			border-left: none;
			margin-left: -1px;
		}
	</style>
</head>
<body style="background-color: #f2f2f2;">
	<div class="container-fluid">
		<h1 style="text-align:center; color:#4CAF50;">AI Code Bot</h1>
		<div id="messages"></div>
		<form id="form">
			<div class="input-field col s12">
				<textarea id="message" class="materialize-textarea" placeholder="Type your message here..." onkeydown="if(event.keyCode==13){document.getElementById('send').click();return false;}"></textarea>
				<label for="message">Message</label>
			</div>
			<button class="btn waves-effect waves-light" type="submit" name="action" id="send">Send
				<i class="material-icons right">send</i>
			</button>
		</form>
	</div>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js"></script>
	<script>
		const messages = document.getElementById('messages');
		const form = document.getElementById('form');
		const messageInput = document.getElementById('message');

		// Function to add a new message to the chat
		function addMessage(sender, message, isCode = false) {
			const div = document.createElement('div');
			div.classList.add('message');
			if (isCode) {
				div.innerHTML = `
					<span class="code-avatar"></span>
					<span class="sender">${sender}</span>
					<span class="time">${new Date().toLocaleTimeString()}</span>
					<pre class="code"><code class="hljs">${message}</code></pre>
				`;
			} else {
				div.innerHTML = `
					<span class="sender-avatar"></span>
					<span class="sender">${sender}</span>
					<div class="content">
						<p>${message}</p>
					</div>
					<span class="time">${new Date().toLocaleTimeString()}</span>
				`;
			}
			messages.appendChild(div);
			messageInput.value = '';
			messageInput.focus();
			hljs.highlightAll();
		}

		// Event listener for form submission
		form.addEventListener('submit', function(event) {
			event.preventDefault();
			const sender = 'Me';
			const message = messageInput.value;
			addMessage(sender, message);
			// Send user input to API and display response
			fetch('https://hub.czyt.tech/code', {
				method: 'POST',
				body: JSON.stringify({desc: message}),
				headers: {
					'Content-Type': 'application/json'
				}
			})
			.then(response => response.json())
			.then(data => {
				const sender = 'AI';
				const message = data.code;
				const isCode = data.isCode;
				addMessage(sender, message, true);
			})
			.catch(error => console.error(error));
		});
	</script>
</body>
</html>
